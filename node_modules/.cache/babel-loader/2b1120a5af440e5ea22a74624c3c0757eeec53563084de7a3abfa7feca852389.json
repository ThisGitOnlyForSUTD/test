{"ast":null,"code":"import PostDialog from \"@/components/parts/PostDialog.vue\";\nimport WButton from \"@/components/ui/WButton.vue\";\nimport _ from \"lodash\";\nimport UserDialog from \"@/components/parts/UserDialog.vue\";\nexport default {\n  name: \"TabsView\",\n  components: {\n    UserDialog,\n    WButton,\n    PostDialog\n  },\n  data() {\n    return {\n      is_active_posts: true,\n      is_active_users: false,\n      is_active_one_user: false,\n      loadMorePostsDelay: false,\n      loadingMessages: [\"Грузим посты\", \"Соединяемся с спутником\", \"Звоним Илону Маску\"]\n    };\n  },\n  methods: {\n    selectPostsTab() {\n      this.is_active_posts = true;\n      this.is_active_users = false;\n    },\n    selectUsersTab() {\n      this.is_active_posts = false;\n      this.is_active_users = true;\n    },\n    showPostsUser(userId, username) {\n      this.selectPostsTab();\n      this.is_active_one_user = true;\n      this.name_filtered_user = username;\n      this.posts = [];\n      this.$store.dispatch('fetchComments', userId);\n    },\n    clearFilter() {\n      this.posts = [];\n      this.is_active_one_user = false;\n      this.$store.dispatch('fetchPosts');\n    },\n    fHandleScroll() {\n      if (window.scrollY + window.innerHeight >= document.body.scrollHeight - 50 && !this.is_active_one_user && !this.isLoading && !this.loadMorePostsDelay) {\n        this.loadMorePostsDelay = true;\n        setTimeout(() => {\n          this.$store.state.page++;\n          this.$store.dispatch('fetchPosts');\n          this.loadMorePostsDelay = false;\n        }, 3000);\n      }\n    }\n  },\n  computed: {\n    loadingMessage() {\n      if (this.isLoading || this.loadMorePostsDelay) {\n        const randomIndex = Math.floor(Math.random() * this.loadingMessages.length);\n        return this.loadingMessages[randomIndex];\n      }\n      return \"\";\n    },\n    currentComments() {\n      return this.$store.state.commentsGroupBy;\n    },\n    isLoading() {\n      return this.$store.state.loading;\n    },\n    posts() {\n      return this.$store.state.posts;\n    },\n    comments() {\n      return this.$store.state.comments;\n    },\n    users() {\n      return this.$store.state.users;\n    },\n    currentUser() {\n      return _.keyBy(this.users, \"id\");\n    }\n  },\n  mounted() {\n    this.$store.dispatch('fetchPosts');\n    this.$store.dispatch('fetchComments');\n    this.$store.dispatch('fetchUsers');\n    window.addEventListener(\"scroll\", this.fHandleScroll);\n  },\n  beforeUnmount() {\n    window.removeEventListener(\"scroll\", this.fHandleScroll);\n  }\n};","map":{"version":3,"names":["PostDialog","WButton","_","UserDialog","name","components","data","is_active_posts","is_active_users","is_active_one_user","loadMorePostsDelay","loadingMessages","methods","selectPostsTab","selectUsersTab","showPostsUser","userId","username","name_filtered_user","posts","$store","dispatch","clearFilter","fHandleScroll","window","scrollY","innerHeight","document","body","scrollHeight","isLoading","setTimeout","state","page","computed","loadingMessage","randomIndex","Math","floor","random","length","currentComments","commentsGroupBy","loading","comments","users","currentUser","keyBy","mounted","addEventListener","beforeUnmount","removeEventListener"],"sources":["/Users/danilagalitskiy/PhpstormProjects/wahelpwe/src/components/TabsView.vue"],"sourcesContent":["<template>\n  <div class=\"tabs-view\">\n    <div class=\"tabs-view__tabs\">\n      <div\n        :class=\"['tabs-view__tab', { active: is_active_posts }]\"\n        @click=\"selectPostsTab\"\n      >\n        Посты\n      </div>\n      <div\n        :class=\"['tabs-view__tab', { active: is_active_users }]\"\n        @click=\"selectUsersTab\"\n      >\n        Пользователи\n      </div>\n    </div>\n    <div class=\"tabs-view__content\">\n      <div\n        class=\"tabs-view__current-user\"\n        v-if=\"is_active_one_user && is_active_posts\"\n      >\n        <h2>\n          <strong>\n            Посты пользователя:\n          </strong>\n          {{ name_filtered_user }}\n        </h2>\n        <w-button\n          text=\"Закрыть\"\n          close\n          @click=\"clearFilter\"\n        />\n      </div>\n      <div\n        v-for=\"post in posts\"\n        :key=\"post.id\"\n        :class=\"['posts_list', { hidden: !is_active_posts }]\"\n      >\n        <post-dialog\n          :user=\"currentUser[post.userId]?.name\"\n          :post=\"post.body\"\n          :comments=\"currentComments[post.id]\"\n          :postId=\"post.id\"\n          @getPosts=\"$store.dispatch('fetchPosts')\"\n        />\n      </div>\n      <p v-if=\"isLoading || loadMorePostsDelay\">{{ loadingMessage }}...</p>\n      <div\n        v-for=\"user in users\"\n        :key=\"user.id\"\n        :class=\"[{ hidden: !is_active_users }]\"\n      >\n        <user-dialog\n          :userId=\"user.id\"\n          :username=\"user.name\"\n          :is_active_posts=\"is_active_posts\"\n          :is_active_users=\"is_active_users\"\n          @showPostsUser=\"showPostsUser\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport PostDialog from \"@/components/parts/PostDialog.vue\";\nimport WButton from \"@/components/ui/WButton.vue\";\nimport _ from \"lodash\";\nimport UserDialog from \"@/components/parts/UserDialog.vue\";\nexport default {\n  name: \"TabsView\",\n  components: {\n    UserDialog,\n    WButton,\n    PostDialog,\n  },\n  data() {\n    return {\n      is_active_posts: true,\n      is_active_users: false,\n      is_active_one_user: false,\n      loadMorePostsDelay: false,\n      loadingMessages: [\n        \"Грузим посты\",\n        \"Соединяемся с спутником\",\n        \"Звоним Илону Маску\",\n      ],\n    };\n  },\n\n  methods: {\n    selectPostsTab() {\n      this.is_active_posts = true;\n      this.is_active_users = false;\n    },\n\n    selectUsersTab() {\n      this.is_active_posts = false;\n      this.is_active_users = true;\n    },\n\n    showPostsUser(userId, username) {\n      this.selectPostsTab();\n      this.is_active_one_user = true;\n      this.name_filtered_user = username;\n      this.posts = [];\n      this.$store.dispatch('fetchComments', userId)\n    },\n\n    clearFilter() {\n      this.posts = [];\n      this.is_active_one_user = false;\n      this.$store.dispatch('fetchPosts')\n    },\n\n    fHandleScroll() {\n      if (\n          window.scrollY + window.innerHeight >= document.body.scrollHeight - 50 &&\n          !this.is_active_one_user &&\n          !this.isLoading &&\n          !this.loadMorePostsDelay\n      ) {\n        this.loadMorePostsDelay = true\n        setTimeout(() => {\n          this.$store.state.page++;\n          this.$store.dispatch('fetchPosts')\n          this.loadMorePostsDelay = false\n        }, 3000)\n      }\n    },\n  },\n  computed: {\n    loadingMessage() {\n      if (this.isLoading || this.loadMorePostsDelay) {\n        const randomIndex = Math.floor(Math.random() * this.loadingMessages.length);\n        return this.loadingMessages[randomIndex]\n      }\n      return \"\"\n    },\n    currentComments() {\n      return this.$store.state.commentsGroupBy\n    },\n    isLoading() {\n      return this.$store.state.loading\n    },\n    posts() {\n      return this.$store.state.posts\n    },\n    comments() {\n      return this.$store.state.comments\n    },\n    users() {\n      return this.$store.state.users\n    },\n    currentUser() {\n     return  _.keyBy(this.users, \"id\")\n    }\n  },\n  mounted() {\n    this.$store.dispatch('fetchPosts')\n    this.$store.dispatch('fetchComments')\n    this.$store.dispatch('fetchUsers')\n    window.addEventListener(\"scroll\", this.fHandleScroll);\n  },\n\n  beforeUnmount() {\n    window.removeEventListener(\"scroll\", this.fHandleScroll);\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.tabs-view {\n  width: 100%;\n  max-width: 900px;\n  margin: 0 auto;\n  &__tabs {\n    display: flex;\n    justify-content: center;\n    gap: 60px;\n    align-items: center;\n  }\n\n  &__tab {\n    padding: 10px 15px;\n    border-radius: 40px;\n    cursor: pointer;\n  }\n\n  &__content {\n    margin-top: 20px;\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n  }\n}\n.active {\n  background-color: grey;\n}\n.hidden {\n  display: none;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}